
STORE .T. TO WCARGANDO
DO WHILE WCARGANDO
   @ WLIN04+0,WCOL04+0 CLEAR to WLIN04+4,WCOL04+55
   @ WLIN04+0,WCOL04+0       to WLIN04+4,WCOL04+55 DOUBLE
   @ WLIN04+0,WCOL04+5 SAY " TIPOS DE INGRESOS "
   @ WLIN04+1,WCOL04+1  SAY "GRUPO       :"
   @ WLIN04+2,WCOL04+1  SAY "SUBGRUPO    :"
   STORE "INGRESE EL CODIGO SOLICITADO ( *ELIMINA*=ELIMINAR CODIGO, <ESC>=SALIR)" TO MES
   DO MENSAJE WITH MES
   @ WLIN04+1,WCOL04+15  GET WINGGRU
   READ
   IF WINGGRU=SPACE(3) .OR. WINGGRU="000" .OR.READKEY()=12.OR.READKEY()=268
      EXIT
   ENDIF
   STORE WINGGRU+"000000" TO WCLAVE
   SELECT 4
   FIND &WCLAVE
   IF EOF()
      DO FILLOC
      APPEND BLANK
      UNLOCK
      DO RECLOC
      REPLACE GRUPO     WITH WINGGRU
      REPLACE SUBGRUPO  WITH "000000"
      FLUSH
      @ WLIN04+1,WCOL04+25 GET DESCRI
      READ
      unlock
      IF READKEY()=12.OR.READKEY()=268
         LOOP
      ENDIF
   ELSE
      do recloc
      @ WLIN04+1,WCOL04+25 GET DESCRI
      READ
      unlock
      IF READKEY()=12.OR.READKEY()=268
         LOOP
      ENDIF
      IF DESCRI = "*ELIMINA*"
         STORE "ESTA SEGURO QUE DESEA ELIMINAR ? (S/N)" TO TEX
         STORE "NS" TO WCH
         DO PREGUNTA
         IF WCH = "N"
            LOOP
         ELSE
            SELECT 4
            DO FILLOC
            DELETE
            UNLOCK
            LOOP
         ENDIF
      ENDIF
      FLUSH
   ENDIF
   @ WLIN04+2,WCOL04+15 GET WINGSUB
   READ
   IF WINGSUB=SPACE(6) .OR. WINGSUB="000000" .OR.READKEY()=12.OR.READKEY()=268
      LOOP
   ENDIF
   STORE WINGGRU+WINGSUB TO WCLAVE
   SELECT 4
   FIND &WCLAVE
   IF EOF()
      DO FILLOC
      APPEND BLANK
      UNLOCK
      DO RECLOC
      REPLACE GRUPO    WITH WINGGRU
      REPLACE SUBGRUPO WITH WINGSUB
      FLUSH
      @ WLIN04+2,WCOL04+25 GET DESCRI
      READ
      unlock
      IF READKEY()=12.OR.READKEY()=268
         LOOP
      ENDIF
   ELSE
      do recloc
      @ WLIN04+2,WCOL04+25 GET DESCRI
      READ
      unlock
      IF READKEY()=12.OR.READKEY()=268
         LOOP
      ENDIF
      IF DESCRI = "*ELIMINA*"
         STORE "ESTA SEGURO QUE DESEA ELIMINAR ? (S/N)" TO TEX
         STORE "NS" TO WCH
         DO PREGUNTA
         IF WCH = "N"
            LOOP
         ELSE
            SELECT 4
            DO FILLOC
            DELETE
            UNLOCK
            LOOP
         ENDIF
      ENDIF
      FLUSH
   ENDIF
ENDDO
RETURN

STORE .T. TO WCARGANDO
DO WHILE WCARGANDO
   @ WLIN03+0,WCOL03+0 CLEAR to WLIN03+4,WCOL03+55
   @ WLIN03+0,WCOL03+0       to WLIN03+4,WCOL03+55 DOUBLE
   @ WLIN03+0,WCOL03+5 SAY " UBICACION GEOGRAFICA "
   @ WLIN03+1,WCOL03+1  SAY "GRUPO       :"
   @ WLIN03+2,WCOL03+1  SAY "SUBGRUPO    :"
   @ WLIN03+3,WCOL03+1  SAY "RENGLON     :"
   STORE "INGRESE EL CODIGO SOLICITADO ( *ELIMINA*=ELIMINAR CODIGO, <ESC>=SALIR)" TO MES
   DO MENSAJE WITH MES
   @ WLIN03+1,WCOL03+15  GET WGEOGRU
   READ
   IF WGEOGRU=SPACE(3) .OR. WGEOGRU="000" .OR.READKEY()=12.OR.READKEY()=268
      EXIT
   ENDIF
   STORE WGEOGRU+"000"+"000" TO WCLAVE
   SELECT 3
   FIND &WCLAVE
   IF EOF()
      DO FILLOC
      APPEND BLANK
      UNLOCK
      DO RECLOC
      REPLACE GRUPO     WITH WGEOGRU
      REPLACE SUBGRUPO  WITH "000"
      REPLACE RENGLON   WITH "000"
      FLUSH
      @ WLIN03+1,WCOL03+20 GET DESCRI
      READ
      unlock
      IF READKEY()=12.OR.READKEY()=268
         LOOP
      ENDIF
   ELSE
      do recloc
      @ WLIN03+1,WCOL03+20 GET DESCRI
      READ
      unlock
      IF READKEY()=12.OR.READKEY()=268
         LOOP
      ENDIF
      IF DESCRI = "*ELIMINA*"
         STORE "ESTA SEGURO QUE DESEA ELIMINAR ? (S/N)" TO TEX
         STORE "NS" TO WCH
         DO PREGUNTA
         IF WCH = "N"
            LOOP
         ELSE
            DO FILLOC
            DELETE
            UNLOCK
            LOOP
         ENDIF
      ENDIF
      FLUSH
   ENDIF
   @ WLIN03+2,WCOL03+15 GET WGEOSUB
   READ
   IF WGEOSUB=SPACE(3) .OR. WGEOSUB="000" .OR.READKEY()=12.OR.READKEY()=268
      LOOP
   ENDIF
   STORE WGEOGRU+WGEOSUB+"000" TO WCLAVE
   SELECT 3
   FIND &WCLAVE
   IF EOF()
      DO FILLOC
      APPEND BLANK
      UNLOCK
      DO RECLOC
      REPLACE GRUPO    WITH WGEOGRU
      REPLACE SUBGRUPO WITH WGEOSUB
      REPLACE RENGLON  WITH "000"
      FLUSH
      @ WLIN03+2,WCOL03+20 GET DESCRI
      READ
      unlock
      IF READKEY()=12.OR.READKEY()=268
         LOOP
      ENDIF
   ELSE
      do recloc
      @ WLIN03+2,WCOL03+20 GET DESCRI
      READ
      unlock
      IF READKEY()=12.OR.READKEY()=268
         LOOP
      ENDIF
      IF DESCRI = "*ELIMINA*"
         STORE "ESTA SEGURO QUE DESEA ELIMINAR ? (S/N)" TO TEX
         STORE "NS" TO WCH
         DO PREGUNTA
         IF WCH = "N"
            LOOP
         ELSE
            DO FILLOC
            DELETE
            UNLOCK
            LOOP
         ENDIF
      ENDIF
      FLUSH
   ENDIF
   @ WLIN03+3,WCOL03+15 GET WGEOREN
   READ
   IF WGEOREN=SPACE(3) .OR. WGEOREN="000" .OR.READKEY()=12.OR.READKEY()=268
      LOOP
   ENDIF
   STORE WGEOGRU+WGEOSUB+WGEOREN TO WCLAVE
   SELECT 3
   FIND &WCLAVE
   IF EOF()
      DO FILLOC
      APPEND BLANK
      UNLOCK
      DO RECLOC
      REPLACE GRUPO    WITH WGEOGRU
      REPLACE SUBGRUPO WITH WGEOSUB
      REPLACE RENGLON  WITH WGEOREN
      FLUSH
      @ WLIN03+3,WCOL03+20 GET DESCRI
      READ
      unlock
      IF READKEY()=12.OR.READKEY()=268
         LOOP
      ENDIF
   ELSE
      do recloc
      @ WLIN03+3,WCOL03+20 GET DESCRI
      READ
      unlock
      IF READKEY()=12.OR.READKEY()=268
         LOOP
      ENDIF
      IF DESCRI = "*ELIMINA*"
         STORE "ESTA SEGURO QUE DESEA ELIMINAR ? (S/N)" TO TEX
         STORE "NS" TO WCH
         DO PREGUNTA
         IF WCH = "N"
            LOOP
         ELSE
            DO FILLOC
            DELETE
            UNLOCK
            LOOP
         ENDIF
      ENDIF
      FLUSH
   ENDIF
ENDDO
RETURN
